---
title: "Cross‑League Soccer Analysis"
output:
  flexdashboard::flex_dashboard:
    theme:
      version: 4
      bootswatch: journal    
    orientation: rows        
    vertical_layout: fill
runtime: shiny
---

<style>
  body, .cell-content { text-align: left !important; }
  .navbar-default { padding-top:5px; padding-bottom:5px; }
  /* new: left‐ and right‐alignment helpers */
  .left-align  { text-align: left  !important; }
  .right-align { text-align: right !important; }
</style>


```{r Setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r Libraries, echo = FALSE}
library(ggthemes)
library(plotly)
library(flexdashboard)
library(readr)
library(dplyr)
library(janitor)
library(polite)
library(purrr)
library(rvest)
library(stringr)
library(tidyverse)
```

```{r Data, echo = FALSE}
# Load CSV files
squads    <- read_csv("squads.csv")
standings <- read_csv("standings.csv")
```

# ABOUT
=====================================

Column {data-width=600 .left-align}
-------------------------

#### Introduction

In this project, we explore soccer statistics from multiple professional football leagues using data from FBref (https://fbref.com/en/comps), a trusted site for advanced football analytics. While we initially focused on Major League Soccer (MLS), we extended our analysis to include other major international competitions such as the Premier League, La Liga, Bundesliga, and Serie A.

Our goal was to collect and organize standardized squad-level statistics across leagues to support comparative analysis. Specifically, we targeted the "Squad Standard Stats" tables on each competition’s main stats page. These tables contain information on team performance metrics such as matches played, goals, assists, average age, possession %, and more.

Column {data-width=600 .left-align}
-------------------------

#### Method

We chose this dataset primarily out of personal interest: one of us enjoys following global football news, while the other is an avid FC25 player. Beyond our curiosity, we recognized that this data offers a rich opportunity for cross-league comparisons.

By scraping the same type of statistics from each league, we aimed to answer questions such as:

-   Do older squads tend to score more or less?
-   Is there a relationship between average age and possession percentage?
-   How does team performance (e.g., goals, assists) vary across leagues?

These questions open the door for future data visualizations (like scatterplots or heatmaps) and statistical modeling (e.g., regression of goals on age or possession).

Column {data-width=400 .right-align}
-------------------------

```{r about-image, echo=FALSE}
renderImage({
  list(
    src    = "Big_five.jpg",
    alt    = "Big Five League Logos",
    width  = 400,
    height = 400
  )
})
```

Standings 
==========================

```{r}
DT::renderDataTable({
	DT::datatable(standings, options = list(
			pageLength = 5,
			lengthMenu = list(c(5, 10, 20, 40, -1), c("5", "10", "20", "40", "All"))
	), rownames = FALSE)
})
```

---

Attacking Stats 
==========================

Column {data-width = 400}
-------------------------

### Average Age vs. Goals

```{r Avg Age vs Goals}
renderPlot({
	squads |> 
		ggplot() +
			geom_point(aes(x = age, y = gls, color = league, shape = league), size = 3) +
			labs(title = "Team Average Age vs. Goals by League",
					 x = "Average Age",
					 y = "Goals",
					 color = "League",
					 shape = "League") +
			scale_color_colorblind()
})
```

Column {data-width=400}
-------------------------

### Possession vs. Goals by League

```{r Possession vs Goals}
renderPlot({
	squads |> 
		ggplot() +
			geom_point(aes(x = poss, y = gls, color = league), size = 2, show.legend = F) +
			facet_wrap(~league) +
			labs(title = "Possession vs. Goals by League",
					 x = "Possession",
					 y = "Goals") +
			scale_color_colorblind()
})
```

Column {data-width=400}
-------------------------

### Top 5 Teams by Goals per Game

```{r Top Teams Goals per Game}
renderPlot({
	squads |>
		group_by(league) |> 
		slice_max(goals_per_game, n = 5) |> 
		ggplot() +
			geom_col(aes(x = fct_reorder(squad, goals_per_game),
									 y = goals_per_game,
									 fill = league)) +
			labs(title = "Top 5 Teams by Goals per Game by League",
					 x = "Squad",
					 y = "Goals per Game",
					 fill = "League") +
			coord_flip() +
			scale_fill_colorblind()
})
```

---

Conclusion 
==========================

Column {data-width = 200}
-------------------------

## Takeaways

- Older squads often correlate with higher scoring efficiency.  
- Possession percentage has a variable relationship with goals.  
- Top-performing teams consistently outscore their league averages.

## Next Steps

1. Build regression models per league.  
2. Incorporate expected goals (xG).  
3. Add time-series analysis across seasons.


